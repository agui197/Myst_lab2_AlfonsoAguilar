Historico$Capital[i]<-Historico$Capital[i-1]+venta-Historico$Comisiones[i]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una venta"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
else{
Historico$Mensaje[i] <- "No hubo activos suficientes"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # Sin se?al
Historico$Mensaje[i] <- "No hubo un rendimiento que activara la señal"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
Historico$R_Precio[74] >= Regla6_V
for(i in 2:length(Historico$Date)){
if(Historico$R_Precio[i] <= Regla0_R){ # Generar Se?al
# Establecer capital actual, inicialmente, igual al capital anterior
Historico$Capital[i] <- Historico$Capital[i-1]
if(Historico$Capital[i] > 0){ # Si hay capital
if(Historico$Capital[i]*Regla2_P > Historico$Precio[i]){ # Si Capital minimo
Historico$Operacion[i] <- "Compra"
Historico$Titulos[i]   <- (Historico$Capital[i]*Regla2_P)%/%Historico$Precio[i]
compra <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- compra*Regla4_C
Historico$Titulos_a[i] <- Historico$Titulos[i-1]+Historico$Titulos[i]
Historico$Capital[i]<-Historico$Capital[i-1]-compra-Historico$Comisiones[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una compra"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # No hubo capital
Historico$Mensaje[i] <- "P"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else if(Historico$R_Precio[i] >= Regla6_V){ #aparece una señal de venta
if(Historico$Titulos_a[i-1] > 0){ #Si hay acciones para vender
Historico$Operacion[i] <- "Venta"
Historico$Titulos[i] <-Historico$Titulos_a[i-1]
venta <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- venta*Regla4_C
Historico$Titulos_a[i] <-0
Historico$Capital[i]<-Historico$Capital[i-1]+venta-Historico$Comisiones[i]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una venta"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
else{
Historico$Mensaje[i] <- "No hubo activos suficientes"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # Sin se?al
Historico$Mensaje[i] <- "No hubo un rendimiento que activara la señal"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
for(i in 2:length(Historico$Date)){
if(Historico$R_Precio[i] <= Regla0_R){ # Generar Se?al
# Establecer capital actual, inicialmente, igual al capital anterior
Historico$Capital[i] <- Historico$Capital[i-1]
if(Historico$Capital[i] > 0){ # Si hay capital
if(Historico$Capital[i]*Regla2_P > Historico$Precio[i]){ # Si Capital minimo
Historico$Operacion[i] <- "Compra"
Historico$Titulos[i]   <- (Historico$Capital[i]*Regla2_P)%/%Historico$Precio[i]
compra <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- compra*Regla4_C
Historico$Titulos_a[i] <- Historico$Titulos[i-1]+Historico$Titulos[i]
Historico$Capital[i]<-Historico$Capital[i-1]-compra-Historico$Comisiones[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una compra"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # No hubo capital
Historico$Mensaje[i] <- "P"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else if(Historico$R_Precio[i] >= Regla6_V){ #aparece una señal de venta
if(Historico$Titulos_a[i-1] > 0){ #Si hay acciones para vender
Historico$Operacion[i] <- "Venta"
Historico$Titulos[i] <-Historico$Titulos_a[i-1]
venta <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- venta*Regla4_C
Historico$Titulos_a[i] <-0
Historico$Capital[i]<-Historico$Capital[i-1]+venta-Historico$Comisiones[i]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una venta"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
else{
Historico$Mensaje[i] <- "No hubo activos suficientes"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # Sin se?al
Historico$Mensaje[i] <- "No hubo un rendimiento que activara la señal"
Historico$Operacion[i] <- "N/A"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
Historico$R_Cuenta[1]<-Historico$Capital[1]+Historico$Balance[1]
for(i in 2:length(Historico$Date)){
if(Historico$R_Precio[i] <= Regla0_R){ # Generar Se?al
# Establecer capital actual, inicialmente, igual al capital anterior
Historico$Capital[i] <- Historico$Capital[i-1]
if(Historico$Capital[i] > 0){ # Si hay capital
if(Historico$Capital[i]*Regla2_P > Historico$Precio[i]){ # Si Capital minimo
Historico$Operacion[i] <- "Compra"
Historico$Titulos[i]   <- (Historico$Capital[i]*Regla2_P)%/%Historico$Precio[i]
compra <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- compra*Regla4_C
Historico$Titulos_a[i] <- Historico$Titulos[i-1]+Historico$Titulos[i]
Historico$Capital[i]<-Historico$Capital[i-1]-compra-Historico$Comisiones[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una compra"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # No hubo capital
Historico$Mensaje[i] <- "P"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else if(Historico$R_Precio[i] >= Regla6_V){ #aparece una señal de venta
if(Historico$Titulos_a[i-1] > 0){ #Si hay acciones para vender
Historico$Operacion[i] <- "Venta"
Historico$Titulos[i] <-Historico$Titulos_a[i-1]
venta <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- venta*Regla4_C
Historico$Titulos_a[i] <-0
Historico$Capital[i]<-Historico$Capital[i-1]+venta-Historico$Comisiones[i]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una venta"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
else{
Historico$Mensaje[i] <- "No hubo activos suficientes"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # Sin se?al
Historico$Mensaje[i] <- "No hubo un rendimiento que activara la señal"
Historico$Operacion[i] <- "N/A"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Comisiones[i]<-Historico$Titulos[i]*Historico$Precio[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
908*111.93
111.93/70.33
for(i in 2:length(Historico$Date)){
if(Historico$R_Precio[i] <= Regla0_R){ # Generar Se?al
# Establecer capital actual, inicialmente, igual al capital anterior
Historico$Capital[i] <- Historico$Capital[i-1]
if(Historico$Capital[i] > 0){ # Si hay capital
if(Historico$Capital[i]*Regla2_P > Historico$Precio[i]){ # Si Capital minimo
Historico$Operacion[i] <- "Compra"
Historico$Titulos[i]   <- (Historico$Capital[i]*Regla2_P)%/%Historico$Precio[i]
compra <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- compra*Regla4_C
Historico$Titulos_a[i] <- Historico$Titulos[i-1]+Historico$Titulos[i]
Historico$Capital[i]<-Historico$Capital[i-1]-compra-Historico$Comisiones[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una compra"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # No hubo capital
Historico$Mensaje[i] <- "P"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else if(Historico$R_Activo[i] >= Regla6_V){ #aparece una señal de venta
if(Historico$Titulos_a[i-1] > 0){ #Si hay acciones para vender
Historico$Operacion[i] <- "Venta"
Historico$Titulos[i] <-Historico$Titulos_a[i-1]
venta <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- venta*Regla4_C
Historico$Titulos_a[i] <-0
Historico$Capital[i]<-Historico$Capital[i-1]+venta-Historico$Comisiones[i]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una venta"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
else{
Historico$Mensaje[i] <- "No hubo activos suficientes"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # Sin se?al
Historico$Mensaje[i] <- "No hubo un rendimiento que activara la señal"
Historico$Operacion[i] <- "N/A"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Comisiones[i]<-Historico$Titulos[i]*Historico$Precio[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
Regla6_V <- (.1)+2*(Regla4_C)
for(i in 2:length(Historico$Date)){
if(Historico$R_Precio[i] <= Regla0_R){ # Generar Se?al
# Establecer capital actual, inicialmente, igual al capital anterior
Historico$Capital[i] <- Historico$Capital[i-1]
if(Historico$Capital[i] > 0){ # Si hay capital
if(Historico$Capital[i]*Regla2_P > Historico$Precio[i]){ # Si Capital minimo
Historico$Operacion[i] <- "Compra"
Historico$Titulos[i]   <- (Historico$Capital[i]*Regla2_P)%/%Historico$Precio[i]
compra <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- compra*Regla4_C
Historico$Titulos_a[i] <- Historico$Titulos[i-1]+Historico$Titulos[i]
Historico$Capital[i]<-Historico$Capital[i-1]-compra-Historico$Comisiones[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una compra"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # No hubo capital
Historico$Mensaje[i] <- "P"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else if(Historico$R_Precio[i] >= Regla6_V){ #aparece una señal de venta
if(Historico$Titulos_a[i-1] > 0){ #Si hay acciones para vender
Historico$Operacion[i] <- "Venta"
Historico$Titulos[i] <-Historico$Titulos_a[i-1]
venta <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- venta*Regla4_C
Historico$Titulos_a[i] <-0
Historico$Capital[i]<-Historico$Capital[i-1]+venta-Historico$Comisiones[i]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una venta"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
else{
Historico$Mensaje[i] <- "No hubo activos suficientes"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # Sin se?al
Historico$Mensaje[i] <- "No hubo un rendimiento que activara la señal"
Historico$Operacion[i] <- "N/A"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Comisiones[i]<-Historico$Titulos[i]*Historico$Precio[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
plot(Historico$R_Cuenta)
19740+284*71.55*.0025
284*71.55*.0025
19740+284*71.55*.0025
19740*1.05
19740*1.05+284*71.55*.0025
for(i in 2:length(Historico$Date)){
if(Historico$R_Precio[i] <= Regla0_R){ # Generar Se?al
# Establecer capital actual, inicialmente, igual al capital anterior
Historico$Capital[i] <- Historico$Capital[i-1]
if(Historico$Capital[i] > 0){ # Si hay capital
if(Historico$Capital[i]*Regla2_P > Historico$Precio[i]){ # Si Capital minimo
Historico$Operacion[i] <- "Compra"
Historico$Titulos[i]   <- (Historico$Capital[i]*Regla2_P)%/%Historico$Precio[i]
compra <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- compra*Regla4_C
Historico$Titulos_a[i] <- Historico$Titulos[i-1]+Historico$Titulos[i]
Historico$Capital[i]<-Historico$Capital[i-1]-compra-Historico$Comisiones[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una compra"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # No hubo capital
Historico$Mensaje[i] <- "P"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
#else if(Historico$R_Precio[i] >= Regla6_V){ #aparece una señal de venta
else if(Historico$Balance[i]>=Historico$Balance[i-1]*(1+Regla6_V)+Historico$Titulos_a*Historico$Precio*Regla4_C){
if(Historico$Titulos_a[i-1] > 0){ #Si hay acciones para vender
Historico$Operacion[i] <- "Venta"
Historico$Titulos[i] <-Historico$Titulos_a[i-1]
venta <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- venta*Regla4_C
Historico$Titulos_a[i] <-0
Historico$Capital[i]<-Historico$Capital[i-1]+venta-Historico$Comisiones[i]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una venta"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
else{
Historico$Mensaje[i] <- "No hubo activos suficientes"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # Sin se?al
Historico$Mensaje[i] <- "No hubo un rendimiento que activara la señal"
Historico$Operacion[i] <- "N/A"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Comisiones[i]<-Historico$Titulos[i]*Historico$Precio[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
for(i in 2:length(Historico$Date)){
if(Historico$R_Precio[i] <= Regla0_R){ # Generar Se?al
# Establecer capital actual, inicialmente, igual al capital anterior
Historico$Capital[i] <- Historico$Capital[i-1]
if(Historico$Capital[i] > 0){ # Si hay capital
if(Historico$Capital[i]*Regla2_P > Historico$Precio[i]){ # Si Capital minimo
Historico$Operacion[i] <- "Compra"
Historico$Titulos[i]   <- (Historico$Capital[i]*Regla2_P)%/%Historico$Precio[i]
compra <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- compra*Regla4_C
Historico$Titulos_a[i] <- Historico$Titulos[i-1]+Historico$Titulos[i]
Historico$Capital[i]<-Historico$Capital[i-1]-compra-Historico$Comisiones[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una compra"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # No hubo capital
Historico$Mensaje[i] <- "P"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
#else if(Historico$R_Precio[i] >= Regla6_V){ #aparece una señal de venta
else if(Historico$Titulos_a[i-1]*Historico$Precio[i]>=Historico$Balance[i-1]*(1+Regla6_V)+Historico$Titulos_a*Historico$Precio*Regla4_C){
if(Historico$Titulos_a[i-1] > 0){ #Si hay acciones para vender
Historico$Operacion[i] <- "Venta"
Historico$Titulos[i] <-Historico$Titulos_a[i-1]
venta <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- venta*Regla4_C
Historico$Titulos_a[i] <-0
Historico$Capital[i]<-Historico$Capital[i-1]+venta-Historico$Comisiones[i]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una venta"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
else{
Historico$Mensaje[i] <- "No hubo activos suficientes"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # Sin se?al
Historico$Mensaje[i] <- "No hubo un rendimiento que activara la señal"
Historico$Operacion[i] <- "N/A"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Comisiones[i]<-Historico$Titulos[i]*Historico$Precio[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
View(Historico)
1159*62.52
1159*69.42
72460.68*1.05+1159*69.42*.0025
Regla6_V <- (.05)+2*(Regla4_C)
for(i in 2:length(Historico$Date)){
if(Historico$R_Precio[i] <= Regla0_R){ # Generar Se?al
# Establecer capital actual, inicialmente, igual al capital anterior
Historico$Capital[i] <- Historico$Capital[i-1]
if(Historico$Capital[i] > 0){ # Si hay capital
if(Historico$Capital[i]*Regla2_P > Historico$Precio[i]){ # Si Capital minimo
Historico$Operacion[i] <- "Compra"
Historico$Titulos[i]   <- (Historico$Capital[i]*Regla2_P)%/%Historico$Precio[i]
compra <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- compra*Regla4_C
Historico$Titulos_a[i] <- Historico$Titulos[i-1]+Historico$Titulos[i]
Historico$Capital[i]<-Historico$Capital[i-1]-compra-Historico$Comisiones[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una compra"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # No hubo capital
Historico$Mensaje[i] <- "P"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Capital insuficiente"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
#else if(Historico$R_Precio[i] >= Regla6_V){ #aparece una señal de venta
else if(Historico$Titulos_a[i-1]*Historico$Precio[i]>=Historico$Balance[i-1]*(1+Regla6_V)+Historico$Titulos_a*Historico$Precio*Regla4_C){
if(Historico$Titulos_a[i-1] > 0){ #Si hay acciones para vender
Historico$Operacion[i] <- "Venta"
Historico$Titulos[i] <-Historico$Titulos_a[i-1]
venta <- Historico$Precio[i]*Historico$Titulos[i]
Historico$Comisiones[i] <- venta*Regla4_C
Historico$Titulos_a[i] <-0
Historico$Capital[i]<-Historico$Capital[i-1]+venta-Historico$Comisiones[i]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$Mensaje[i] <- "Se hizo una venta"
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
else{
Historico$Mensaje[i] <- "Activos insuficientes"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
else { # Sin se?al
Historico$Mensaje[i] <- "No hubo un rendimiento que activara la señal"
Historico$Operacion[i] <- "N/A"
Historico$Capital[i]<-Historico$Capital[i-1]
Historico$Titulos[i] <-0
Historico$Comisiones[i]<-Historico$Titulos[i]*Historico$Precio[i]
Historico$Titulos_a[i]<-Historico$Titulos[i]+Historico$Titulos_a[i-1]
Historico$Balance[i] <- Historico$Titulos_a[i]*Historico$Precio[i]
Historico$R_Cuenta[i]<-Historico$Capital[i]+Historico$Balance[i]
}
}
